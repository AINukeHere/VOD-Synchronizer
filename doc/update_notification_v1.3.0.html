<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>업데이트 알림</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background: #f5f5f5;
            padding: 20px;
            margin: 0;
        }
        
        .update-container {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 500px;
            margin: 0 auto;
            padding: 25px;
        }
        
        .version-number {
            font-size: 20px;
            font-weight: 600;
            color: #007bff;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .changes-list {
            list-style: none;
            padding: 0;
        }
        
        .changes-list li {
            padding: 8px 0 8px 20px;
            font-size: 16px;
            line-height: 1.5;
            position: relative;
        }
        
        .changes-list li::before {
            content: '•';
            color: #007bff;
            position: absolute;
            left: 0;
        }
    </style>
</head>
<body>
    <div class="update-container">
        <div class="version-number" id="versionNumber">v1.3.0 주요 변경사항</div>
        <ul class="changes-list" id="changesList">
            <li>SOOP --> CHZZK 동기화 기능이 추가되어 이제 플랫폼 간 양방향 동기화가 가능합니다.</li>
            <li>전역 동기화 버튼이 추가되었습니다. 해당 VOD를 기준으로 나머지 열려있는 VOD들을 동기화합니다.</li>
            <img src="../screenshots/broadcastSync.png" alt="전역 동기화 버튼" style="max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
            <li>[SOOP과 동기화] 패널과 [CHZZK과 동기화] 패널이 [타 플랫폼과 동기화] 패널로 통합되었습니다.</li>
            <li>그 외 기능 개선 및 버그 수정 사항은 <a href="https://github.com/AINukeHere/VOD-Synchronizer/blob/main/README.md#%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8-%EB%82%B4%EC%97%AD" target="_blank">README</a>를 참고하세요.</li>
        </ul>
    </div>

    <script>
        // 페이지 로드 완료 후 부모 페이지에 크기 정보 전송
        function sendSizeToParent() {
            // 컨텐츠 컨테이너의 실제 크기 측정
            const updateContainer = document.querySelector('.update-container');
            
            if (updateContainer) {
                // 컨테이너의 실제 렌더링 크기 측정
                const rect = updateContainer.getBoundingClientRect();
                const computedStyle = window.getComputedStyle(updateContainer);
                
                // 패딩과 마진을 고려한 실제 크기 계산
                const paddingTop = parseFloat(computedStyle.paddingTop) || 0;
                const paddingBottom = parseFloat(computedStyle.paddingBottom) || 0;
                const paddingLeft = parseFloat(computedStyle.paddingLeft) || 0;
                const paddingRight = parseFloat(computedStyle.paddingRight) || 0;
                
                const width = rect.width + paddingLeft + paddingRight;
                const height = rect.height + paddingTop + paddingBottom;
                
                // 디버깅을 위한 로그
                console.log('컨텐츠 크기 측정 결과:', {
                    rectWidth: rect.width,
                    rectHeight: rect.height,
                    paddingTop,
                    paddingBottom,
                    paddingLeft,
                    paddingRight,
                    최종너비: width,
                    최종높이: height,
                    bodyScrollHeight: document.body.scrollHeight,
                    htmlScrollHeight: document.documentElement.scrollHeight
                });
                
                // 부모 페이지에 크기 정보 전송
                if (window.parent && window.parent !== window) {
                    console.log('크기 전송', width, height);
                    window.parent.postMessage({
                        type: 'vodSync-iframe-resize',
                        width: width,
                        height: height
                    }, '*');
                }
            } else {
                console.error('컨텐츠 컨테이너를 찾을 수 없습니다.');
            }
        }
        
        // DOM 로드 완료 후 크기 전송
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', sendSizeToParent);
        } else {
            sendSizeToParent();
        }
        
        // 추가로 약간의 지연을 두고 한 번 더 전송 (폰트 로딩 등 고려)
        setTimeout(sendSizeToParent, 100);
    </script>

</body>
</html>
